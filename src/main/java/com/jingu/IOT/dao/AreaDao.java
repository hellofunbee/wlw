package com.jingu.IOT.dao;import com.jingu.IOT.requset.AreaReq;import org.springframework.beans.factory.annotation.Qualifier;import org.springframework.jdbc.core.JdbcTemplate;import org.springframework.stereotype.Component;import javax.annotation.Resource;import java.util.List;import java.util.Map;@Componentpublic class AreaDao {    @Resource    @Qualifier("primaryJdbcTemplate")    private JdbcTemplate jdbcTemplate;    // for_type: 【GIS】1、2、3：生产、物种、信息预警 、【信息发布】4：即时、预警消息    public List<Map<String, Object>> listProvince(AreaReq a) {        String sql = "select * from  s_area a where right(a.ar_id,4)='0000'";        if (a.getFor_type() == 1) {            sql += " and a.ar_id in ( " +                    " select d_province from distribution where d_type = 1 " +                    ")";        }        if (a.getFor_type() == 2) {            sql += " and a.ar_id in ( " +                    " select d_province from distribution where d_type = 2 " +                    ")";        }        if (a.getFor_type() == 3) {            sql += " and a.ar_id in ( " +                    " select m_province from message where m_type = 3 " +                    ")";        }        return jdbcTemplate.queryForList(sql);    }    public List<Map<String, Object>> listCity(AreaReq a) {        String sql = "select * from  s_area a where left(a.ar_id,2)=left(?,2) and right(a.ar_id,2) ='00' and SUBSTR(a.ar_id FROM 3 FOR 2) !='00'";        if (a.getFor_type() == 1) {            sql += " and a.ar_id in ( " +                    " select d_city from distribution where d_type = 1 " +                    ")";        }        if (a.getFor_type() == 2) {            sql += " and a.ar_id in ( " +                    " select d_city from distribution where d_type = 2 " +                    ")";        }        if (a.getFor_type() == 3) {            sql += " and a.ar_id in ( " +                    " select m_city from message where m_type = 3 " +                    ")";        }        return jdbcTemplate.queryForList(sql, a.getAr_id());    }    public List<Map<String, Object>> listDistrict(AreaReq a) {        String sql = "select * from  s_area a where left(a.ar_id,4)=left(?,4) and right(a.ar_id,2) !='00' and right(a.ar_id,2) !='01'";        if (a.getFor_type() == 1) {            sql += " and a.ar_id in ( " +                    " select d_district from distribution where d_type = 1 " +                    ")";        }        if (a.getFor_type() == 2) {            sql += " and a.ar_id in ( " +                    " select d_district from distribution where d_type = 2 " +                    ")";        }        if (a.getFor_type() == 3) {            sql += " and a.ar_id in ( " +                    " select m_district from message where m_type = 3 " +                    ")";        }        return jdbcTemplate.queryForList(sql, a.getAr_id());    }}