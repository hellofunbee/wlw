<html><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width,initial-scale=1">    <title></title>    <link rel="stylesheet" href="css/reset.min.css">    <link rel="stylesheet" href="css/zTreeStyle/zTreeStyle.css">    <link rel="stylesheet" href="css/style.css"></head><body><div class="mx-main">    <!--<script type="text/javascript" src="js/ipcParamsCheck.js"></script>-->    <div class="xxx-layer" style="display: block">        <div class="left-info">            <h4>码流类型：</h4>            <p>                <select name="streamType" value="main" required field="streamType" id="streamType" size="1"                        onchange="onStreamTypeChange()">                    <option value='main'>主码流</option>                    <option value='sub1'>子码流</option>                </select>            </p>            <h4>分辨率：</h4>            <p>                <select name="resolution" field="resolution" required id="resolution" size="1"                        onchange="uiVideoFrameRateAndBitrate()">                </select>            </p>            <h4>帧率：</h4>            <p>                <select name="videoFrameRate" field="videoFrameRate" required id="videoFrameRate" size="1">                </select>            </p>            <h4>码率：<i style="color: red" name="videoitrateRange" id="videoitrateRange"></i></h4>            <p>                <input type="text" name="videoBitrate" field="videoBitrate" required id="videoBitrate" class="text">            </p>            <h4>编码类型：</h4>            <p>                <select name="videoEncodeType" field="videoEncodeType" required id="videoEncodeType" size="1"                        onchange="uiEncodeEfficiency()">                </select>            </p>            <h4 width="120">编码复杂度：</h4>            <p>                <select name="videoEncodeEfficiency" field="videoEncodeEfficiency" required id="videoEncodeEfficiency"                        size="1">                </select>            </p>            <div class="tc mt20 ">                <a class="btn-lg btn-df-blue" onClick="checkForm();" id="btnSave1">保存参数</a>            </div>        </div>    </div>    <script type="text/javascript">if (!window.jQuery) {        var html = '<script src="js/jquery.min.js"><\/script>\n<script src="js/jquery.scrollTo.min.js"><\/script>\n<script src="js/jquery.bgiframe-2.1.2.js"><\/script>\n<script src="js/jquery.ztree.all.min.js"><\/script>\n<script src="js/layer/laydate/laydate.js"><\/script>\n<script src="js/layer/layer.js"><\/script>\n<script src="js/slide.js"><\/script>\n<script src="js/common.js"><\/script>\n<script src="js/purl.js"><\/script>\n<script src="js/api.js"><\/script>\n<script src="js/ui.js"><\/script>';        document.write(html)    }    </script>    <script type="text/javascript" src="js/check.js"></script>    <script type="text/javascript">        var a = $("div#main_iframe").attr("src") || location.href;        var item = JSON.parse(decodeURIComponent(purl(a).param("data")));        var jsonStr = '{"mainChannel":{"channelType":"main","solutions":[{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17,22","index":"19","name":"720P","resolution":"1280*720"},{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17,22","index":"20","name":"XVGA","resolution":"1280*960"},{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17","index":"27","name":"HD1080P","resolution":"1920*1080"},{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17","index":"30","name":"2048*1536","resolution":"2048*1536"}],"videoEncodeTypes":[{"videoEncodeType":"1","videoEncodeEfficiency":"0,1,2"},{"videoEncodeType":"10","videoEncodeEfficiency":"1"}]},"subChannel":{"channelType":"sub1","solutions":[{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17","index":"1","name":"CIF","resolution":"352*288"},{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17","index":"16","name":"VGA","resolution":"640*480"},{"videoBitrate":"32,16384","videoFrameRate":"0,1,2,3,4,5,6,7,8,9,10,11,14,12,15,13,16,17","index":"3","name":"4CIF","resolution":"704*576"}],"videoEncodeTypes":[{"videoEncodeType":"1","videoEncodeEfficiency":"0,1,2"},{"videoEncodeType":"7","videoEncodeEfficiency":"0,1,2"},{"videoEncodeType":"10","videoEncodeEfficiency":"1"}]},"servletWrapper":{},"action":""}';        var videoShema = JSON.parse(jsonStr);        jsonStr = '{"sub1Stream":{"videoBitrate":"1024","videoFrameRate":"0","videoEncodeType":"1","videoEncodeEfficiency":"1","servletWrapper":{},"action":"","resolution":"3","videoBitrateRaw":"19"},"mainStream":{"videoBitrate":"800","videoFrameRate":"7","videoEncodeType":"10","videoEncodeEfficiency":"1","servletWrapper":{},"action":"","resolution":"30","videoBitrateRaw":"-2146664448"},"servletWrapper":{},"action":""}';        var videoParams = JSON.parse(jsonStr);        API.service("/getIPCCodeing", {            mapingDeviceId: item.mapingDeviceId,            deviceId: item.deviceId,            pointEntity: {ip: item.s_ip, port: item.s_port},            id: item.id,            ipcProxyId: item.ipcProxyId,            ipcCtrlProxyId: item.ipcCtrlProxyId,            type: 2        }, function (data) {            videoShema = JSON.parse(JSON.stringify(data.object.ablity));            videoParams = JSON.parse(JSON.stringify(data.object.setting));            setShema();            setCfg();        });        var currStreamType;        var streamObj;        function checkForm() {            var vals = UI.getFieldValue($('.left-info'));            if (!vals) {                return false;            }            var obj = {};            obj.mapingDeviceId = item.mapingDeviceId;            obj.deviceId = item.deviceId;            obj.pointEntity = {ip: item.ip, port: item.port};            obj.id = item.id;            obj.ipcProxyId = item.ipcProxyId;            obj.ipcCtrlProxyId = item.ipcCtrlProxyId;            obj.type = 2;            obj.cktime = 1;            if (vals.streamType == 'main') {                obj.videoParamsBean = {                    mainStream: {                        videoEncodeType: vals.videoEncodeType,                        videoEncodeEfficiency: vals.videoEncodeEfficiency,                        resolution: vals.resolution,                        videoFrameRate: vals.videoFrameRate,                        videoBitrate: vals.videoBitrate                    }                }            }            if (vals.streamType == 'sub1') {                obj.videoParamsBean = {                    sub1Stream: {                        videoEncodeType: vals.videoEncodeType,                        videoEncodeEfficiency: vals.videoEncodeEfficiency,                        resolution: vals.resolution,                        videoFrameRate: vals.videoFrameRate,                        videoBitrate: vals.videoBitrate                    }                }            }            API.service("/setIPCCodeing", obj, function (e) {             layer.msg(e.msg)             });        }        function setCfg() {            currStreamType = $("#streamType").val();            if (currStreamType == "main") streamObj = videoParams.mainStream;            if (currStreamType == "sub1") streamObj = videoParams.sub1Stream;            //设置分辨率            $("#resolution").val(streamObj.resolution);            uiVideoFrameRateAndBitrate();            $("#videoFrameRate").val(streamObj.videoFrameRate);            $("#videoBitrate").val(streamObj.videoBitrate);            //设置编码类型            $("#videoEncodeType").val(streamObj.videoEncodeType);            uiEncodeEfficiency();            $("#videoEncodeEfficiency").val(streamObj.videoEncodeEfficiency);        }        var schemaTypeObj;        function setShema() {            currStreamType = $("#streamType").val();            if (currStreamType == "main") schemaTypeObj = videoShema.mainChannel;            if (currStreamType == "sub1") schemaTypeObj = videoShema.subChannel;            uiResolution();            uiVideoFrameRateAndBitrate();            uiEncodeType();            uiEncodeEfficiency();        }        function onStreamTypeChange() {            //更新UI            setShema();            //更新参数            setCfg();        }        function uiResolution() {            $("#resolution").empty();//清空            var resolutionLs = schemaTypeObj.solutions;            for (var i = 0; i < resolutionLs.length; i++) {                $("#resolution").append("<option value='" + resolutionLs[i].index + "'>" + resolutionLs[i].name + "(" + resolutionLs[i].resolution + ")</option>");            }        }        function uiVideoFrameRateAndBitrate() {            var index = $("#resolution").val();            $("#videoFrameRate").empty();//清空            var resolutionLs = schemaTypeObj.solutions;            for (var i = 0; i < resolutionLs.length; i++) {                if (resolutionLs[i].index == index) {                    var frmLs = resolutionLs[i].videoFrameRate.split(",");                    for (var j = 0; j < frmLs.length; j++) {                        $("#videoFrameRate").append("<option value='" + frmLs[j] + "'>" + getVideoFrameRateName(frmLs[j]) + "</option>");                    }                    $("#videoitrateRange").html("范围（ " + resolutionLs[i].videoBitrate.replace(',', '~') + '）');                }            }        }        function uiEncodeType() {            $("#videoEncodeType").empty();//清空            for (var i = 0; i < schemaTypeObj.videoEncodeTypes.length; i++) {                $("#videoEncodeType").append("<option value='" + schemaTypeObj.videoEncodeTypes[i].videoEncodeType + "'>" + getEncodeTypeName(schemaTypeObj.videoEncodeTypes[i].videoEncodeType) + "</option>");            }        }        function uiEncodeEfficiency() {            var videoEncodeType = $("#videoEncodeType").val();            $("#videoEncodeEfficiency").empty();//清空            for (var i = 0; i < schemaTypeObj.videoEncodeTypes.length; i++) {                if (schemaTypeObj.videoEncodeTypes[i].videoEncodeType == videoEncodeType) {                    var effList = schemaTypeObj.videoEncodeTypes[i].videoEncodeEfficiency.split(",");                    for (var j = 0; j < effList.length; j++) {                        $("#videoEncodeEfficiency").append("<option value='" + effList[j] + "'>" + getEncodeEfficiencyName(effList[j]) + "</option>");                    }                }            }        }        function getEncodeTypeName(et) {            if (et == "0") return "私有264";            if (et == "1") return "标准h264";            if (et == "2") return "标准mpeg4";            if (et == "7") return "M-JPEG";            if (et == "8") return "MPEG2";            if (et == "9") return "SVAC";            if (et == "10") return "标准h265";            if (et == "254") return "自动（和源一致）";            return "无效";        }        function getEncodeEfficiencyName(et) {            if (et == "0") return "低";            if (et == "1") return "中";            if (et == "2") return "高";            if (et == "254") return "自动";            return "无效";        }        function getVideoFrameRateName(et) {            if (et == "0") return "全部";            if (et == "1") return "1/16";            if (et == "2") return "1/8";            if (et == "3") return "1/4";            if (et == "4") return "1/2";            if (et == "5") return "1";            if (et == "6") return "2";            if (et == "7") return "4";            if (et == "8") return "6";            if (et == "9") return "8";            if (et == "10") return "10";            if (et == "11") return "12";            if (et == "12") return "16";            if (et == "13") return "20";            if (et == "14") return "15";            if (et == "15") return "18";            if (et == "16") return "22";            if (et == "17") return "25";            if (et == "18") return "30";            if (et == "19") return "35";            if (et == "20") return "40";            if (et == "21") return "45";            if (et == "22") return "50";            if (et == "23") return "55";            if (et == "24") return "60";            if (et == "25") return "3";            if (et == "26") return "5";            if (et == "27") return "7";            if (et == "28") return "9";            if (et == "29") return "100";            if (et == "30") return "120";            if (et == "21") return "24";            if (et == "32") return "48";            if (et == "4294967294") return "自动（和源一致）";            return "无效";        }    </script></div></body></html>